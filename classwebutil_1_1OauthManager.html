<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Axel Backend: webutil::OauthManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Axel Backend
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classwebutil_1_1OauthManager.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classwebutil_1_1OauthManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">webutil::OauthManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Responsible for storing and providing formatted requests and their required information for each step of one Oauth session.  
 <a href="classwebutil_1_1OauthManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="OauthManager_8h_source.html">OauthManager.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aae11b313a487b277e60a73466b105d2f"><td class="memItemLeft" align="right" valign="top"><a id="aae11b313a487b277e60a73466b105d2f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#aae11b313a487b277e60a73466b105d2f">OauthManager</a> ()</td></tr>
<tr class="memdesc:aae11b313a487b277e60a73466b105d2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor. <br /></td></tr>
<tr class="separator:aae11b313a487b277e60a73466b105d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef41dfcab156a29493279cf62525be8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#aef41dfcab156a29493279cf62525be8e">OauthManager</a> (<a class="el" href="classwebutil_1_1PkceManager.html">PkceManager</a> pkce_manager, <a class="el" href="classwebutil_1_1StateHashManager.html">StateHashManager</a> state_hash_manager, <a class="el" href="classwebutil_1_1TokenRequestManager.html">TokenRequestManager</a> token_request_manager)</td></tr>
<tr class="memdesc:aef41dfcab156a29493279cf62525be8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs an <a class="el" href="classwebutil_1_1OauthManager.html" title="Responsible for storing and providing formatted requests and their required information for each step...">OauthManager</a> instance.  <a href="classwebutil_1_1OauthManager.html#aef41dfcab156a29493279cf62525be8e">More...</a><br /></td></tr>
<tr class="separator:aef41dfcab156a29493279cf62525be8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa5b145f9dcdaaf5478ee3fea28b92d5"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#afa5b145f9dcdaaf5478ee3fea28b92d5">get_authorization_url</a> ()</td></tr>
<tr class="memdesc:afa5b145f9dcdaaf5478ee3fea28b92d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the authorization url.  <a href="classwebutil_1_1OauthManager.html#afa5b145f9dcdaaf5478ee3fea28b92d5">More...</a><br /></td></tr>
<tr class="separator:afa5b145f9dcdaaf5478ee3fea28b92d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99a81c12f32e1a367c0b390032ca7d50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#a99a81c12f32e1a367c0b390032ca7d50">make_token_request</a> ()</td></tr>
<tr class="memdesc:a99a81c12f32e1a367c0b390032ca7d50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constucts the HTTP POST request for token exchange.  <a href="classwebutil_1_1OauthManager.html#a99a81c12f32e1a367c0b390032ca7d50">More...</a><br /></td></tr>
<tr class="separator:a99a81c12f32e1a367c0b390032ca7d50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96751a503a5a642980efa5e3ee1cd9a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#a96751a503a5a642980efa5e3ee1cd9a5">send_token_request</a> ()</td></tr>
<tr class="memdesc:a96751a503a5a642980efa5e3ee1cd9a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the access token exchange request.  <a href="classwebutil_1_1OauthManager.html#a96751a503a5a642980efa5e3ee1cd9a5">More...</a><br /></td></tr>
<tr class="separator:a96751a503a5a642980efa5e3ee1cd9a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab653b3a20a36e7e67b184a0febfc1792"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#ab653b3a20a36e7e67b184a0febfc1792">receive_authorization_code</a> (const std::string &amp;url_string)</td></tr>
<tr class="memdesc:ab653b3a20a36e7e67b184a0febfc1792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accept an authorization code to be used in future Oauth steps.  <a href="classwebutil_1_1OauthManager.html#ab653b3a20a36e7e67b184a0febfc1792">More...</a><br /></td></tr>
<tr class="separator:ab653b3a20a36e7e67b184a0febfc1792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b1aa1478425aa74040fa9ac9bb4e8d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwebutil_1_1OauthManager.html#a78b1aa1478425aa74040fa9ac9bb4e8d">get_state_hash</a> () const</td></tr>
<tr class="memdesc:a78b1aa1478425aa74040fa9ac9bb4e8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the state hash.  <a href="classwebutil_1_1OauthManager.html#a78b1aa1478425aa74040fa9ac9bb4e8d">More...</a><br /></td></tr>
<tr class="separator:a78b1aa1478425aa74040fa9ac9bb4e8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Responsible for storing and providing formatted requests and their required information for each step of one Oauth session. </p>
<p>Includes methods that serve the authorization URL, state parameter verification and access token exchange. All required messages (URLs, HTTP requests) must not be constructed manually. They are only to be taken from this class.</p>
<dl class="section note"><dt>Note</dt><dd>Only one <a class="el" href="classwebutil_1_1OauthManager.html" title="Responsible for storing and providing formatted requests and their required information for each step...">OauthManager</a> instance should exist per Oauth session. </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aef41dfcab156a29493279cf62525be8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef41dfcab156a29493279cf62525be8e">&#9670;&nbsp;</a></span>OauthManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">webutil::OauthManager::OauthManager </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classwebutil_1_1PkceManager.html">PkceManager</a>&#160;</td>
          <td class="paramname"><em>pkce_manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classwebutil_1_1StateHashManager.html">StateHashManager</a>&#160;</td>
          <td class="paramname"><em>state_hash_manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classwebutil_1_1TokenRequestManager.html">TokenRequestManager</a>&#160;</td>
          <td class="paramname"><em>token_request_manager</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs an <a class="el" href="classwebutil_1_1OauthManager.html" title="Responsible for storing and providing formatted requests and their required information for each step...">OauthManager</a> instance. </p>
<p>All Oauth resource (formatted requests, state hashes, etc.) should be obtained through this class only.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkce_manager</td><td>Instance of <a class="el" href="classwebutil_1_1PkceManager.html" title="Responsible for managing Pkce (Proof Key for Code Exchange) code verifiers and challenges.">PkceManager</a>. </td></tr>
    <tr><td class="paramname">state_hash_manager</td><td>Instance of <a class="el" href="classwebutil_1_1StateHashManager.html" title="The StateHashManager class.">StateHashManager</a>. </td></tr>
    <tr><td class="paramname">token_request_manager</td><td>Instance of <a class="el" href="classwebutil_1_1TokenRequestManager.html">TokenRequestManager</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afa5b145f9dcdaaf5478ee3fea28b92d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa5b145f9dcdaaf5478ee3fea28b92d5">&#9670;&nbsp;</a></span>get_authorization_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string webutil::OauthManager::get_authorization_url </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets the authorization url. </p>
<dl class="section return"><dt>Returns</dt><dd>Authorisation url. This is intended to be served to the client when it first contacts the Lambda function. </dd></dl>

</div>
</div>
<a id="a78b1aa1478425aa74040fa9ac9bb4e8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78b1aa1478425aa74040fa9ac9bb4e8d">&#9670;&nbsp;</a></span>get_state_hash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string webutil::OauthManager::get_state_hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the state hash. </p>
<dl class="section return"><dt>Returns</dt><dd>The state hash string. </dd></dl>

</div>
</div>
<a id="a99a81c12f32e1a367c0b390032ca7d50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99a81c12f32e1a367c0b390032ca7d50">&#9670;&nbsp;</a></span>make_token_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void webutil::OauthManager::make_token_request </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constucts the HTTP POST request for token exchange. </p>
<p>Contains all relevant fields as specified in the PoE Developer Docs. Relevant documentation: <a href="https://www.pathofexile.com/developer/docs/authorization">https://www.pathofexile.com/developer/docs/authorization</a></p>
<dl class="section note"><dt>Note</dt><dd>Checks that the authorization code is available in the class and is valid before allowing this operation. </dd></dl>

</div>
</div>
<a id="ab653b3a20a36e7e67b184a0febfc1792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab653b3a20a36e7e67b184a0febfc1792">&#9670;&nbsp;</a></span>receive_authorization_code()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void webutil::OauthManager::receive_authorization_code </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>url_string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accept an authorization code to be used in future Oauth steps. </p>
<p>Checks the received HTTP url_string to determined if the state parameter matches, then updates the state of the <a class="el" href="classwebutil_1_1OauthManager.html" title="Responsible for storing and providing formatted requests and their required information for each step...">OauthManager</a> to allow for <a class="el" href="classwebutil_1_1OauthManager.html#a99a81c12f32e1a367c0b390032ca7d50" title="Constucts the HTTP POST request for token exchange.">make_token_request()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">url_string</td><td>The HTTP url_string containing the authorization code </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if state_ is not AUTH_OK, or if the state or authorization code is not found in the query parameters. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a96751a503a5a642980efa5e3ee1cd9a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96751a503a5a642980efa5e3ee1cd9a5">&#9670;&nbsp;</a></span>send_token_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void webutil::OauthManager::send_token_request </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the access token exchange request. </p>
<p>Once a response is received, store the returned access token and refresh token</p>
<dl class="section note"><dt>Note</dt><dd>Checks that the access token HTTP request message is ready in the first place before allowing this operation. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/auth/include/<a class="el" href="OauthManager_8h_source.html">OauthManager.h</a></li>
<li>src/auth/src/OauthManager.cpp</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>webutil</b></li><li class="navelem"><a class="el" href="classwebutil_1_1OauthManager.html">OauthManager</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
